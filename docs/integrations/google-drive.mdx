# Google Drive Integration (GA)

Integrate Google Drive with your app using OpenInt's native OAuth 2.0 flow. This guide shows you how to register your app on Google Cloud, configure OAuth for Drive, and connect securely for metadata access, following Google Workspace best practices.

> **Stage:** General Availability (GA)

## Prerequisites

- Google Cloud Platform (GCP) account with permissions to manage APIs and OAuth consent.
- Your OpenInt deployment configured and reachable.
- Access to the [Google API Console](https://console.developers.google.com/).

## 1. Register Your Application in Google Cloud Console

1. **Sign in** to [Google API Console](https://console.developers.google.com/).
2. Click the **Select a project** dropdown and choose an existing project or **Create a new project**.
3. In the left sidebar, go to **APIs & Services > Enabled APIs & services**, then click **+ ENABLE APIS AND SERVICES**.
4. Search for `Drive`, click on **Google Drive API**, then click **Enable**.

## 2. Configure the OAuth Consent Screen

1. In the sidebar, open **APIs & Services > OAuth consent screen**.
2. Choose **External**, click **Create**.
3. Fill in the **App name**, **User support email**, and **Developer contact information**. Other fields are optional.
4. Click **Save and Continue**.
5. On the **Scopes** page, you **must** add only `https://www.googleapis.com/auth/drive.metadata.readonly` for metadata-only access. OpenInt currently ignores or returns an error (`insufficient_scope`) for any other Drive scopes added here. [See all Google Drive scopes.](https://developers.google.com/workspace/drive/api/guides/api-specific-auth#drive-scopes) Click **Save and Continue**.
6. Add yourself or your testers as **Test users** to allow account linking.
7. Continue and **Publish App** when ready. If you see a "Prepare for verification" prompt, skip it unless publishing to all users.

## 3. Create OAuth 2.0 Credentials

1. In the sidebar, go to **APIs & Services > Credentials**.
2. Click **+ CREATE CREDENTIALS > OAuth client ID**.
3. Select **Web application**.
4. Set a recognizable name (e.g., `OpenInt Google Drive Integration`).
5. Add an **Authorized redirect URI** pointing to your OpenInt instance's callback endpoint (URI **must match exactly**, including HTTPS, trailing slashes, and case). E.g.:

    ```
    https://<YOUR_OPENINT_HOST>/api/oauth/callback
    > **Tip:** [Google's redirect URI requirements](https://developers.google.com/identity/protocols/oauth2/web-server#redirect-uri-validation) are strict. If you see a `redirect_uri_mismatch` error, check both Google Console and OpenInt are identical.
    ```
6. Click **Create**. Google will show your **Client ID** and **Client Secret** — copy both and store securely.

## 4. Configure OpenInt for Google Drive

1. In your OpenInt configuration or dashboard, select "Google Drive" as a connector.
2. Enter the **Client ID** and **Client Secret** you generated above.
3. Set the scope to `https://www.googleapis.com/auth/drive.metadata.readonly` (this is the **only** Drive scope currently supported by OpenInt; requests for others are ignored or rejected).
4. Save your connection settings.

## 5. Test Your Connection

Initiate a connection from OpenInt. You should be redirected to Google’s OAuth consent screen, see your configured app name, and be prompted to grant metadata access to Google Drive. Upon success, OpenInt will redirect back to your app and securely store the tokens.

> **Note:** If you encounter errors such as `redirect_uri_mismatch`, double-check that your callback URI in Google and OpenInt match exactly. All parameters (including trailing slashes and protocols) must align.

---

## Supported Google Drive Scopes

Below is a summary of relevant Google Drive scopes. OpenInt currently exposes `drive.metadata.readonly`; additional scopes may be available in the future. For the full, up-to-date list, see the [official Google API scope documentation](https://developers.google.com/workspace/drive/api/guides/api-specific-auth#drive-scopes).

| Scope | Supported by OpenInt? | Description |
|--|--|--|
| <Tooltip text="Full, permissive scope to access all of a user's Drive files.">https://www.googleapis.com/auth/drive</Tooltip> | ❌ | Full access to all files (create, modify, delete, metadata). *Restricted* |
| <Tooltip text="Access only to files created or opened by the app; the user must select files.">https://www.googleapis.com/auth/drive.file</Tooltip> | ❌ | App-specific file access. *Recommended/Non-sensitive* |
| <Tooltip text="Access to the appdata folder for storing configuration/config files.">https://www.googleapis.com/auth/drive.appdata</Tooltip> | ❌ | Only appdata folder (hidden). *Recommended/Non-sensitive* |
| <Tooltip text="Read/write Drive file metadata, no content.">https://www.googleapis.com/auth/drive.metadata</Tooltip> | ❌ | Metadata read/write. *Restricted* |
| <Tooltip text="Read-only Drive file metadata (titles, properties, no content).">https://www.googleapis.com/auth/drive.metadata.readonly</Tooltip> | ✅ | Metadata read-only (supported, default). *Restricted* |
| <Tooltip text="Read-only access to user's Photos/Videos in Drive.">https://www.googleapis.com/auth/drive.photos.readonly</Tooltip> | ❌ | Read-only Google Photos. *Restricted* |
| <Tooltip text="Read-only access to all Drive files, including content and metadata.">https://www.googleapis.com/auth/drive.readonly</Tooltip> | ❌ | All files, read-only (content & metadata). *Restricted* |
| <Tooltip text="Modify Apps Script projects in Drive.">https://www.googleapis.com/auth/drive.scripts</Tooltip> | ❌ | Apps Script modification. *Restricted* |


**Legend:**
- ✅ Supported by OpenInt
- ❌ Not yet supported by OpenInt

> **Note:** OpenInt does **not** require `userinfo.email` or `userinfo.profile` for this integration—only metadata scope is supported at this time. For details and requirement levels (sensitive/restricted), see Google’s [full Drive scope list](https://developers.google.com/workspace/drive/api/guides/api-specific-auth#drive-scopes).

---

## Common Issues & Troubleshooting

<Callout type="warning" title="OAuth Errors">
**redirect_uri_mismatch:** Callback URLs must match exactly in OpenInt and Google Cloud Console.<br/>
**invalid_client:** Incorrect Client ID/Secret – verify and re-enter from Google.
**unverified_app:** App is not published; add test users or publish for general access. See [OAuth consent screen docs](https://developers.google.com/workspace/guides/configure-oauth-consent).
**insufficient_scope:** Only `drive.metadata.readonly` is currently supported; update requested scopes in OpenInt.
</Callout>

<Callout type="info" title="Quota or API Limit Errors">
Every Google Cloud project has per-app and per-user quota limits. If you see errors like `403: User rate limit exceeded`, consider creating dedicated OAuth credentials per integration and avoid sharing credentials across user bases.
</Callout>

## Helpful Resources

- [Google Drive API Scopes (official)](https://developers.google.com/workspace/drive/api/guides/api-specific-auth#drive-scopes)
- [Google OAuth Consent Screen configuration](https://developers.google.com/workspace/guides/configure-oauth-consent)
- [General Google OAuth 2.0 information](https://developers.google.com/identity/protocols/oauth2)
- [OpenInt Getting Started](../getting-started/quickstart)